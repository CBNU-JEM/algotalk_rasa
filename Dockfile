FROM  algotalk/server_base:latest

WORKDIR /home/

ADD https://api.github.com/repos/CBNU-JEM/algotalk_rasa/git/refs/heads/main .

# algotalk_server
RUN git clone https://github.com/CBNU-JEM/algotalk_rasa.git

ENV RASA_DIR /usr/local/lib/python3.7/dist-packages/rasa

RUN cd algotalk_rasa && \
	cp korean_tokenizer.py $RASA_DIR/nlu/tokenizers && \
	cp crf_entity_extractor_korean.py $RASA_DIR/nlu/extractors && \
	cp bilou_utils_Kr.py $RASA_DIR/nlu/utils && \
	cp registry.py $RASA_DIR/nlu
	
ENV HOME /home/algotalk_rasa

RUN mkdir data

WORKDIR $HOME

RUN chmod 755 /home/algotalk_rasa/rasa_run.sh

CMD sh /home/algotalk_rasa/rasa_run.sh